@import "tailwindcss";
@import "highlight.js/styles/atom-one-dark.css";
@import "katex/dist/katex.min.css";

@theme {
  --font-sans: "Inter", ui-sans-serif, system-ui, sans-serif,
    "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";
  
  /* Light Mode Colors */
  --color-bg-primary: #f0eee6;
  --color-bg-secondary: #ffffff;
  --color-bg-tertiary: #f9fafb;
  --color-text-primary: #1f2937;
  --color-text-secondary: #4b5563;
  --color-text-heading: #111827;
  --color-border-primary: #e5e7eb;
  --color-border-secondary: #d1d5db;
  --color-accent: #22c55e;
  --color-accent-hover: #16a34a;
  --color-link: #2563eb;
  --color-link-hover: #1d4ed8;
}

/* Dark Mode Overrides */
[data-theme="dark"] {
  --color-bg-primary: #0f172a;
  --color-bg-secondary: #1e293b;
  --color-bg-tertiary: #334155;
  --color-text-primary: #e2e8f0;
  --color-text-secondary: #94a3b8;
  --color-text-heading: #f1f5f9;
  --color-border-primary: #334155;
  --color-border-secondary: #475569;
  --color-accent: #22c55e;
  --color-accent-hover: #4ade80;
  --color-link: #60a5fa;
  --color-link-hover: #93c5fd;
}

html,
body {
  background-color: var(--color-bg-primary);
  color: var(--color-text-primary);
  margin: 0;
  padding: 0;
  font-family: "Inter", -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  transition: background-color 0.3s ease, color 0.3s ease;
}

* {
  box-sizing: border-box;
}

/* Mobile improvements */
@media (max-width: 768px) {
  body {
    font-size: 16px; /* Prevents iOS zoom on focus */
  }
}

/* Reusable Component Classes with Tailwind */
@layer components {
  /* Background Classes */
  .bg-primary {
    @apply bg-[var(--color-bg-primary)];
  }
  
  .bg-secondary {
    @apply bg-[var(--color-bg-secondary)];
  }
  
  .bg-tertiary {
    @apply bg-[var(--color-bg-tertiary)];
  }
  
  /* Text Classes */
  .text-primary {
    @apply text-[var(--color-text-primary)];
  }
  
  .text-secondary {
    @apply text-[var(--color-text-secondary)];
  }
  
  .text-heading {
    @apply text-[var(--color-text-heading)];
  }
  
  /* Border Classes */
  .border-primary {
    @apply border-[var(--color-border-primary)];
  }
  
  .border-secondary {
    @apply border-[var(--color-border-secondary)];
  }
  
  /* Link Classes */
  .link {
    @apply text-[var(--color-link)] hover:text-[var(--color-link-hover)] underline font-medium transition-colors;
  }
  
  /* Navigation Links */
  .nav-link {
    @apply italic transition-colors;
    color: var(--color-text-primary);
  }
  
  .nav-link:hover {
    color: var(--color-accent);
  }
  
  .nav-link-active {
    @apply italic;
    color: var(--color-accent);
  }
  
  /* Card Component */
  .card {
    @apply rounded-lg p-4;
    background-color: var(--color-bg-secondary);
    border: 1px solid var(--color-border-primary);
  }
  
  /* Button Component */
  .btn-primary {
    @apply bg-[var(--color-accent)] hover:bg-[var(--color-accent-hover)] text-white px-4 py-2 rounded-md transition-colors;
  }
  
  /* Theme Toggle */
  .theme-toggle {
    @apply p-2 rounded-md cursor-pointer transition-all flex items-center justify-center;
    background-color: var(--color-bg-secondary);
    color: var(--color-text-primary);
    border: 1px solid var(--color-border-primary);
  }
  
  .theme-toggle:hover {
    background-color: var(--color-bg-tertiary);
    border-color: var(--color-accent);
  }
  
  /* Select Input */
  .select-themed {
    @apply rounded px-3 py-2 text-sm w-full md:w-auto;
    border: 1px solid var(--color-border-primary);
    background-color: var(--color-bg-secondary);
    color: var(--color-text-primary);
  }
  
  /* Article/Project Item */
  .item-card {
    @apply pb-4;
    border-bottom: 1px solid var(--color-border-primary);
  }
  
  .item-title {
    @apply text-base md:text-lg block mb-2 transition-colors;
    color: var(--color-link);
  }
  
  .item-title:hover {
    color: var(--color-link-hover);
  }
  
  .item-meta {
    @apply text-xs md:text-sm block md:inline md:ml-4;
    color: var(--color-text-secondary);
  }
  
  /* Mobile Menu Button */
  .mobile-menu-btn {
    @apply p-2 rounded transition-colors;
    color: var(--color-text-primary);
  }
  
  .mobile-menu-btn:hover {
    background-color: var(--color-bg-tertiary);
  }
  
  /* Error Page */
  .error-container {
    @apply pt-16 p-4 container mx-auto;
  }
  
  .error-stack {
    @apply w-full p-4 overflow-x-auto rounded;
    background-color: var(--color-bg-secondary);
    border: 1px solid var(--color-border-primary);
  }
}

/* Markdown Prose Styling */
@layer components {
  .prose {
    @apply break-words leading-relaxed;
    color: var(--color-text-primary);
  }
}

@layer components {
  .prose h1 {
    @apply text-4xl font-extrabold leading-tight mt-8 mb-4;
    color: var(--color-text-heading);
  }

  .prose h2 {
    @apply text-3xl font-bold leading-snug mt-8 mb-4 pb-2;
    color: var(--color-text-heading);
    border-bottom: 1px solid var(--color-border-primary);
  }

  .prose h3 {
    @apply text-2xl font-semibold leading-snug mt-6 mb-3;
    color: var(--color-text-heading);
  }

  .prose h4 {
    @apply text-xl font-semibold leading-snug mt-6 mb-3;
    color: var(--color-text-heading);
  }

  .prose h5 {
    @apply text-lg font-semibold leading-normal mt-4 mb-2;
    color: var(--color-text-heading);
  }

  .prose h6 {
    @apply text-base font-semibold leading-normal mt-4 mb-2;
    color: var(--color-text-heading);
  }
}

@layer components {
  .prose p {
    @apply mt-0 mb-5 leading-relaxed;
  }

  .prose strong {
    @apply font-bold;
    color: var(--color-text-heading);
  }

  .prose em {
    @apply italic;
  }

  .prose a {
    @apply underline font-medium transition-colors;
    color: var(--color-link);
  }
  
  .prose a:hover {
    color: var(--color-link-hover);
  }

  .prose hr {
    @apply border-0 my-8;
    border-top: 1px solid var(--color-border-primary);
  }
}

@layer components {
  .prose img {
    @apply max-w-full h-auto rounded-lg my-4;
  }

  .prose pre {
    @apply overflow-x-auto rounded-lg my-4 bg-slate-800 dark:bg-slate-900;
    border: 1px solid var(--color-border-secondary);
    padding: 1rem !important;
    -webkit-overflow-scrolling: touch;
  }

  .prose code {
    font-family: 'JetBrains Mono', 'Fira Code', 'Monaco', 'Menlo', 'Consolas', 'Courier New', monospace;
    @apply text-sm leading-relaxed;
  }

  .prose pre code {
    @apply block text-slate-300;
    background: transparent !important;
    padding: 0 !important;
  }

  .prose pre code .hljs {
    background: transparent !important;
  }

  .prose :not(pre) > code {
    @apply bg-amber-100 dark:bg-amber-950 text-red-700 dark:text-red-300 px-1.5 py-0.5 rounded text-sm font-semibold;
    border: 1px solid var(--color-border-secondary);
  }
}

@layer components {
  .prose table {
    @apply block overflow-x-auto w-full my-8 text-sm border-collapse;
    -webkit-overflow-scrolling: touch;
  }

  .prose table th {
    @apply font-bold py-3.5 px-4 text-left;
    background-color: var(--color-bg-tertiary);
    color: var(--color-text-heading);
    border: 1px solid var(--color-border-secondary);
  }

  .prose table td {
    @apply py-3.5 px-4;
    border: 1px solid var(--color-border-primary);
  }

  .prose table tbody tr:nth-child(odd) {
    background-color: var(--color-bg-secondary);
  }

  .prose table tbody tr:nth-child(even) {
    background-color: var(--color-bg-tertiary);
  }

  .prose table tbody tr:hover {
    @apply opacity-80;
    background-color: var(--color-bg-primary);
  }
}

@layer components {
  /* KaTeX styling */
  .math-block {
    @apply overflow-x-auto overflow-y-hidden p-4 my-4 text-center;
  }

  /* Mermaid diagrams */
  .mermaid {
    @apply my-4 flex justify-center;
  }

  /* Blockquotes */
  .prose blockquote {
    @apply pl-6 py-2 my-6 italic rounded;
    border-left: 4px solid var(--color-border-secondary);
    color: var(--color-text-secondary);
    background-color: var(--color-bg-tertiary);
  }

  .prose blockquote p {
    @apply my-2;
  }
}

@layer components {
  /* Lists */
  .prose ul {
    @apply list-disc pl-7 my-5;
  }

  .prose ol {
    @apply list-decimal pl-7 my-5;
  }

  .prose li {
    @apply my-2 leading-relaxed;
  }

  .prose ul ul, 
  .prose ul ol, 
  .prose ol ul, 
  .prose ol ol {
    @apply my-3;
  }

  .prose li p {
    @apply my-3;
  }
}
